## ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ

```
- ì•…ë• ê¸°íšì: ì„œë¹„ìŠ¤ ì˜¤í”ˆ ì§ì „ì— í• ì¸ ì •ì±…ì„ ì§€ê¸ˆì²˜ëŸ¼ ê³ ì • ê¸ˆì•¡ í• ì¸ì´ ì•„ë‹ˆë¼ ì¢€ ë” í•©ë¦¬ì ì¸ ì£¼ë¬¸ ê¸ˆì•¡ë‹¹ í• ì¸í•˜ëŠ” **ì •ë¥ % í• ì¸**ìœ¼ë¡œ ë³€ê²½í•˜ê³  ì‹¶ì–´ìš”. ì˜ˆë¥¼ ë“¤ì–´ì„œ ê¸°ì¡´ ì •ì±…ì€ VIPê°€ 10000ì›ì„ ì£¼ë¬¸í•˜ë“  20000ì›ì„ ì£¼ë¬¸í•˜ë“  í•­ìƒ 1000ì›ì„ í• ì¸í–ˆëŠ”ë°, ì´ë²ˆì— ìƒˆë¡œ ë‚˜ì˜¨ ì •ì±…ì€ 10%ë¡œ ì§€ì •í•´ë‘ë©´ ê³ ê°ì´ 10000ì› ì£¼ë¬¸ì‹œ 1000ì›ì„ í• ì¸í•´ì£¼ê³ , 20000ì› ì£¼ë¬¸ì‹œì— 2000ì›ì„ í• ì¸í•´ì£¼ëŠ” ê±°ì—ìš”
- ìˆœì§„ ê°œë°œì: ì œê°€ ì²˜ìŒë¶€í„° ê³ ì • ê¸ˆì•¡ í• ì¸ì€ ì•„ë‹ˆë¼ê³  í–ˆì–ì•„ìš”.
- ì•…ë• ê¸°íšì: ì• ìì¼ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ì„ ì–¸ ëª°ë¼ìš”? â€œê³„íšì„ ë”°ë¥´ê¸°ë³´ë‹¤ ë³€í™”ì— ëŒ€ì‘í•˜ê¸°ë¥¼â€
- ìˆœì§„ ê°œë°œì: â€¦ (í•˜ì§€ë§Œ ë‚œ ìœ ì—°í•œ ì„¤ê³„ê°€ ê°€ëŠ¥í•˜ë„ë¡ ê°ì²´ì§€í–¥ ì„¤ê³„ ì›ì¹™ì„ ì¤€ìˆ˜í–ˆì§€ í›„í›„
```

> ë³€ë™ëœ í• ì¸ ì •ì±… ì½”ë“œ ì¶”ê°€(RateDiscountPolicy)

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¶”ê°€
- ctrl + shift + Të¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë¥¼ ê°„í¸í•˜ê²Œ ìƒì„±í•  ìˆ˜ ìˆìŒ

> í…ŒìŠ¤íŠ¸ ì„±ê³µ ì¼€ì´ìŠ¤<br> VIP ë“±ê¸‰ì¼ ë•Œ í• ì¸ ì ìš©
<br>

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class RateDiscountPolicyTest {
    RateDiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Test
    @DisplayName("VIPëŠ” 10% í• ì¸ì´ ì ìš©ë˜ì–´ì•¼ í•œë‹¤.")
    void vip_o(){
        // given
        Member member = new Member(1L, "memberVIP", Grade.VIP);
        // when
        int discount = discountPolicy.discount(member, 10000);
        // then
        Assertions.assertThat(discount).isEqualTo(1000);
    }
}
```
<img src="https://github.com/iieunji023/spring-core/blob/main/images/í• ì¸ì •ì±…_í…ŒìŠ¤íŠ¸1.png" width="730">

ğŸ’¡ **ì„±ê³µ í…ŒìŠ¤íŠ¸ë„ ì¤‘ìš”í•˜ì§€ë§Œ, ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ë„ ë§Œë“¤ì–´ë´ì•¼ í•œë‹¤.**

> í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì¼€ì´ìŠ¤<br> BASIC ë“±ê¸‰ì¼ ë•Œ VIP ë“±ê¸‰ê³¼ ë™ì¼í•œ í• ì¸ì •ì±… ì ìš©
<br>

```java
@Test
@DisplayName("VIPê°€ ì•„ë‹ˆë©´ í• ì¸ì´ ì ìš©ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.")
void vip_x() {
    // given
    Member member = new Member(2L, "memberBASIC", Grade.BASIC);
    // when
    int discount = discountPolicy.discount(member, 10000);
    // then
    Assertions.assertThat(discount).isEqualTo(1000);
}
```
<img src="https://github.com/iieunji023/spring-core/blob/main/images/í• ì¸ì •ì±…_í…ŒìŠ¤íŠ¸2.png" width="730">

## ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì 

âš ï¸ ë°©ê¸ˆ ì¶”ê°€í•œ í• ì¸ ì •ì±…(ì •ë¥ )ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì ìš©í•´ë³´ë©´ í´ë¼ì´ì–¸íŠ¸ì¸ `OrderServiceImpl` ì½”ë“œë¥¼ ê³ ì³ì•¼ í•œë‹¤.
```java
package hello.core.order;


import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.discount.RateDiscountPolicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;

public class OrderServiceImpl implements OrderService {
    private final MemberRepository memberRepository = new MemoryMemberRepository();
//    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();

}

```
âš ï¸ ë¬¸ì œì  ë°œê²¬

- ì—­í• ê³¼ êµ¬í˜„ì„ ì¶©ì‹¤í•˜ê²Œ ë¶„ë¦¬í•¨ â†’ OK
- ë‹¤í˜•ì„±ë„ í™œìš©í•˜ê³ , ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ ê°ì²´ë¥¼ ë¶„ë¦¬í•¨ â†’ OK
- OCP, DIP ê°™ì€ ê°ì²´ì§€í–¥ ì„¤ê³„ ì›ì¹™ì„ ì¶©ë¶„íˆ ì¤€ìˆ˜í–ˆë‹¤
    - ê·¸ë ‡ê²Œ ë³´ì´ì§€ë§Œ ì§€í‚¤ì§€ ëª»í•¨
- DIP: ì£¼ë¬¸ì„œë¹„ìŠ¤ í´ë¼ì´ì–¸íŠ¸(`OrderServiceImpl`)ëŠ” `DisplayPolicy` ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ë©´ì„œ DIPë¥¼ ì§€í‚¨ ê²ƒ ì•„ë‹Œê°€?
    - í´ë˜ìŠ¤ ì˜ì¡´ ê´€ê³„ë¥¼ ìƒê°í•´ë³´ë©´ ì¶”ìƒ(ì¸í„°í˜ì´ìŠ¤)ë¿ë§Œ ì•„ë‹ˆë¼ **êµ¬ì²´(êµ¬í˜„) í´ë˜ìŠ¤ì—ë„ ì˜ì¡´**í•˜ê³  ìˆë‹¤.
        - ì¶”ìƒ(ì¸í„°í˜ì´ìŠ¤) ì˜ì¡´: `DiscountPolicy`
        - êµ¬ì²´(êµ¬í˜„) í´ë˜ìŠ¤: `FixDiscountPolicy`, `RateDiscountPolicy`
- OCP: ë³€ê²½í•˜ì§€ ì•Šê³  í™•ì¥í•  ìˆ˜ ìˆëŠ” ê²ƒ
    - **ì§€ê¸ˆ ì½”ë“œëŠ” ê¸°ëŠ¥ì„ í™•ì¥í•´ì„œ ë³€ê²½í•˜ë©´, í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì˜í–¥ì„ ì¤Œ**
        - OCP ìœ„ë°˜ !!

> ê¸°ëŒ€í–ˆë˜ ì˜ì¡´ê´€ê³„

<img src="https://github.com/iieunji023/spring-core/blob/main/images/ì˜ì¡´ê´€ê³„1.png" width="730">

- ì§€ê¸ˆê¹Œì§€ ë‹¨ìˆœíˆ DiscountPolicy ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´í•œë‹¤ê³  ìƒê°

> ì‹¤ì œ ì˜ì¡´ê´€ê³„

<img src="https://github.com/iieunji023/spring-core/blob/main/images/ì˜ì¡´ê´€ê³„2.png" width="730">

- í´ë¼ì´ì–¸íŠ¸ì¸ `OrderServiceImpl`ì´ `DiscountPolicy`ì¸í„°í˜ì´ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ `FixDiscountPolicy`ì¸ êµ¬í˜„ í´ë˜ìŠ¤ë„ í•¨ê»˜ ì˜ì¡´í•˜ê³  ìˆìŒ

> ì •ì±… ë³€ê²½

<img src="https://github.com/iieunji023/spring-core/blob/main/images/ì˜ì¡´ê´€ê³„3.png" width="730">

- â­ ê·¸ë˜ì„œ `FixDiscountPolicy`ë¥¼ `RateDiscountPolicy`ë¡œ ë³€ê²½í•˜ëŠ” ìˆœê°„ `OrderServiceImpl`ì˜ ì†ŒìŠ¤ì½”ë“œë„ í•¨ê»˜ ë³€ê²½í•´ì•¼ í•œë‹¤.
- OCP ìœ„ë°˜

### ë¬¸ì œ í•´ê²° ë°©ë²•
- ë¬¸ì œ ìƒí™©
    - í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì¸ `OrderServiceImpl`ì€ `DiscountPolicy`ì˜ ì¸í„°í˜ì´ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ êµ¬ì²´ í´ë˜ìŠ¤ë„ í•¨ê»˜ ì˜ì¡´í•œë‹¤
    - ê·¸ë˜ì„œ êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•  ë•Œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë„ í•¨ê»˜ ë³€ê²½í•´ì•¼ í•œë‹¤
- í•´ê²°ë°©ë²•
    - **DIP ìœ„ë°˜** â†’ ì¶”ìƒì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ë³€ê²½(ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´)
    - DIPë¥¼ ìœ„ë°˜í•˜ì§€ ì•Šë„ë¡ ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì˜ì¡´ ê´€ê³„ë¥¼ ë³€ê²½í•˜ë©´ ëœë‹¤

> ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì„¤ê³„ë¥¼ ë³€ê²½

<img src="https://github.com/iieunji023/spring-core/blob/main/images/ì˜ì¡´ê´€ê³„4.png" width="730">

```java
 public class OrderServiceImpl implements OrderService {
 //private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
 private DiscountPolicy discountPolicy;
 }
```
- **ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´**í•˜ë„ë¡ ì„¤ê³„ì™€ ì½”ë“œë¥¼ ë³€ê²½í–ˆë‹¤.
- ê·¸ëŸ°ë° êµ¬í˜„ì²´ê°€ ì—†ëŠ”ë° ì–´ë–»ê²Œ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆì„ê¹Œ?
- ì´ì „ì— ë§Œë“¤ì—ˆë˜ OderServiceTest ì‹¤í–‰<br>
    <img src="https://github.com/iieunji023/spring-core/blob/main/images/í…ŒìŠ¤íŠ¸ê²°ê³¼.png" width="730">
    - ì‹¤ì œ ì‹¤í–‰ì„ í•´ë³´ë©´ NPE(null pointer exception)ê°€ ë°œìƒí•œë‹¤
- í•´ê²°ë°©ì•ˆ
    - í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImplì— DiscountPolicyì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ê³  ì£¼ì…í•´ì£¼ì–´ì•¼ í•¨

## ê´€ì‹¬ì‚¬ ë¶„ë¦¬
### AppConfig ë“±ì¥

- ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ êµ¬ì„±(config)í•˜ê¸° ìœ„í•´ **êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**í•˜ê³  **ì—°ê²°**í•˜ëŠ” ì±…ì„ì„ ê°€ì§€ëŠ” ë³„ë„ì˜ ì„¤ì • í´ë˜ìŠ¤ë¥¼ ìƒì„±
- AppConfigëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ë™ì‘ì— í•„ìš”í•œ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤
    - `MemberServiceImpl`
    - `MemoryMemberRepository`
    - `OrderServiceImpl`
    - `FixDiscountPolicy`
- AppConfigëŠ” ìƒì„±í•œ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡°(ë ˆí¼ëŸ°ìŠ¤)ë¥¼ ìƒì„±ìë¥¼ í†µí•´ ì£¼ì…(ì—°ê²°)í•´ì¤€ë‹¤.
    - `MemberServiceImpl` â†’ `MemoryMemberRepository`
    - `OrderServiceImpl` â†’ `MemoryMemberRepository` , `FixDiscountPolicy`

> MemberServiceImpl, OrderServiceImpl ì½”ë“œ ë³€ê²½
- ì² ì €í•˜ê²Œ ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ê²Œ ë¨
- `OrderServiceImpl`ì˜ ê²½ìš° `DiscountPolicy` ì¸í„°í˜ì´ìŠ¤ê°€ `FixedDiscountPolicy`, `RateDiscountPolicy`ë¥¼ ë„£ì–´ì¤„ì§€ëŠ” ëª¨ë¦„

> í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

<img src="https://github.com/iieunji023/spring-core/blob/main/images/í´ë˜ìŠ¤ë‹¤ì´ì–´ê·¸ë¨.png" width="730">

- ê°ì²´ì˜ ìƒì„±ê³¼ ì—°ê±¸ì€ AppConfigê°€ ë‹´ë‹¹
- DIP ì™„ì„±: `MemberServiceImpl`ì€ `MemberRepository`ì¸ ì¶”ìƒì—ë§Œ ì˜ì¡´í•˜ë©´ ë¨
- ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬: ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì—­í• ê³¼ ì‹¤í–‰í•˜ëŠ” ì—­í•  ëª…í™•íˆ ë¶„ë¦¬ë¨

> íšŒì› ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

<img src="https://github.com/iieunji023/spring-core/blob/main/images/íšŒì›_ê°ì²´_ë‹¤ì´ì–´ê·¸ë¨.png" width="730">

- appConfig ê°ì²´ëŠ” `memoryMemberRepository` ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ê·¸ ì°¸ì¡°ê°’ì„ `memberServiceImpl`ì„ ìƒì„±í•˜ë©´ì„œ ìƒì„±ìë¡œ ì „ë‹¬í•œë‹¤
- í´ë¼ì´ì–¸íŠ¸ì¸ `memberServiceImpl` ì…ì¥ì—ì„œ ë³´ë©´ ì˜ì¡´ê´€ê³„ë¥¼ ë§ˆì¹˜ ì™¸ë¶€ì—ì„œ ì£¼ì…í•´ì£¼ëŠ” ê²ƒ ê°™ë‹¤ê³  í•´ì„œ DI(Dependency Injection)ì´ë¼ í•œë‹¤.


### í…ŒìŠ¤íŠ¸
> MemberApp, OrderApp ì½”ë“œ ë³€ê²½
- AppConfigë¥¼ í†µí•´ ìƒì„±ìë¥¼ ì£¼ì…ë°›ìŒ

> MemberServiceTest, OrderServiceTest JUnit í…ŒìŠ¤íŠ¸ ì½”ë“œ ë³€ê²½
- í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ `@BeforeEach` ëŠ” ê° í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— í˜¸ì¶œë¨
  - AppConfigë¥¼ ë°”ë¡œ êº¼ë‚´ì˜¤ê¸° í˜ë“¤ì–´ì„œ @BeforeEachë¡œ ê°€ì ¸ì˜¤ê¸°

### ì •ë¦¬
- AppConfigë¥¼ í†µí•´ ê´€ì‹¬ì‚¬ë¥¼ í™•ì‹¤í•˜ê²Œ ë¶„ë¦¬í•¨
- AppConfigëŠ” ê³µì—° ê¸°íšì
- AppConfigëŠ” êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ì„ íƒí•œë‹¤
  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì–´ë–»ê²Œ ë™ì‘í•´ì•¼ í• ì§€ ì „ì²´ êµ¬ì„±ì„ ì±…ì„ì§„ë‹¤
- `OrderServiceImpl` ì€ ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ëŠ” ì±…ì„ë§Œ ì§€ë©´ ëœë‹¤.

## AppConfig ë¦¬íŒ©í„°ë§
- í˜„ì¬ AppConfigë¥¼ ë³´ë©´ **ì¤‘ë³µ**ì´ ìˆê³  **ì—­í• **ì— ë”°ë¥¸ **êµ¬í˜„**ì´ ì˜ ì•ˆë³´ì¸ë‹¤.

#### ë¦¬íŒ©í„°ë§ í›„
- `new MemoryMemberRepository()` ì´ ë¶€ë¶„ ì¤‘ë³µ ì œê±°
    - `MemoryMemberRepository`ë¥¼ ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ ë³€ê²½í•  ë•Œ í•œ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ë¨
- `AppConfig`ë¥¼ ë³´ë©´ ì—­í• ê³¼ êµ¬í˜„ í´ë˜ìŠ¤ê°€ í•œëˆˆì— ë“¤ì–´ì˜´
    - ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ êµ¬ì„±ì´ ì–´ë–»ê²Œ ë˜ì–´ìˆëŠ”ì§€ ë¹ ë¥´ê²Œ íŒŒì•…í•  ìˆ˜ ìˆìŒ