[## ë¹ˆ ìŠ¤ì½”í”„ë€?

- ìŠ¤í”„ë§ ë¹ˆì€ ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ë¡œ ìƒì„±ëœë‹¤
- ìŠ¤ì½”í”„ëŠ” ë²ˆì—­ ê·¸ëŒ€ë¡œ ë¹ˆì´ ì¡´ì¬í•  ìˆ˜ ìˆëŠ” ë²”ìœ„ë¥¼ ëœ»í•œë‹¤

**ìŠ¤í”„ë§ì€ ë‹¤ì–‘í•œ ìŠ¤ì½”í”„ë¥¼ ì§€ì›í•œë‹¤**

- ì‹±ê¸€í†¤
    - ê¸°ë³¸ ìŠ¤ì½”í”„, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ì‹œì‘ê³¼ ì¢…ë£Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ê°€ì¥ ë„“ì€ ë²”ìœ„ì˜ ìŠ¤ì½”í”„
- í”„ë¡œí† íƒ€ì…
    - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì˜ ìƒì„±ê³¼ ì˜ì¡´ê´€ê³„ ì£¼ì…ê¹Œì§€ë§Œ ê´€ì—¬í•˜ê³  ë”ëŠ” ê´€ë¦¬í•˜ì§€ ì•ŠëŠ” ë§¤ìš° ì§§ì€ ë²”ìœ„ì˜ ìŠ¤ì½”í”„
- ì›¹ ê´€ë ¨ ìŠ¤ì½”í”„
    - request: ì›¹ ìš”ì²­ì´ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆ ë•Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„
    - session: ì›¹ ì„¸ì…˜ì´ ìƒì„±ë˜ê³  ì¢…ë£Œë  ë•Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„
    - application: ì›¹ì˜ ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸ì™€ ê°™ì€ ë²”ìœ„ë¡œ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„

<br>

## í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„

- **ì‹±ê¸€í†¤ ìŠ¤ì½”í”„**ì˜ ë¹ˆì„ ì¡°íšŒí•˜ë©´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í•­ìƒ **ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ì˜ ìŠ¤í”„ë§ ë¹ˆì„ ë°˜í™˜**í•œë‹¤
- ë°˜ë©´ì— **í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„**ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì¡°íšŒí•˜ë©´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” **í•­ìƒ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜**í•œë‹¤

**ì‹±ê¸€í†¤ ë¹ˆ ìš”ì²­**

<img src="https://github.com/iieunji023/spring-core/blob/main/images/ì‹±ê¸€í†¤_ë¹ˆ_ìš”ì²­.png" width="500">

1. ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ì˜ ë¹ˆì„ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•œë‹¤
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ë³¸ì¸ì´ ê´€ë¦¬í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì„ ë°˜í™˜í•œë‹¤
3. ì´í›„ì— ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ê°™ì€ ìš”ì²­ì´ ì™€ë„ ê°™ì€ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ìŠ¤í”„ë§ ë¹ˆì„ ë°˜í™˜í•œë‹¤

**í”„ë¡œí† íƒ€ì… ë¹ˆ ìš”ì²­1**

<img src="https://github.com/iieunji023/spring-core/blob/main/images/í”„ë¡œí† íƒ€ì…_ë¹ˆ_ìš”ì²­1.png" width="500">

1. í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì„ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•œë‹¤
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì´ ì‹œì ì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•˜ê³ , í•„ìš”í•œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•œë‹¤

**í”„ë¡œí† íƒ€ì… ë¹ˆ ìš”ì²­2**

<img src="https://github.com/iieunji023/spring-core/blob/main/images/í”„ë¡œí† íƒ€ì…_ë¹ˆ_ìš”ì²­2.png" width="500">

1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìƒì„±í•œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜í•œë‹¤
2. ì´í›„ì— ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ê°™ì€ ìš”ì²­ì´ ì˜¤ë©´ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•´ì„œ ë°˜í™˜í•œë‹¤

### ì •ë¦¬

- **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•˜ê³ , ì˜ì¡´ê´€ê³„ ì£¼ì…, ì´ˆê¸°í™”ê¹Œì§€ë§Œ ì²˜ë¦¬**í•œë‹¤ëŠ” ê²ƒì´ë‹¤.
- í´ë¼ì´ì–¸íŠ¸ì— ë¹ˆì„ ë°˜í™˜í•˜ê³ , ì´í›„ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìƒì„±ëœ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤
- í”„ë¡œí† íƒ€ì… ë¹ˆì„ ê´€ë¦¬í•  ì±…ì„ì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ë°›ëŠ” í´ë¼ì´ì–¸íŠ¸ì— ìˆë‹¤.
- ê·¸ë˜ì„œ `@PreDestory` ê°™ì€ ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

> **ì‹±ê¸€í†¤ íƒ€ì… ìŠ¤ì½”í”„**
<br> - scope/SingletonTest.java
- ì¶œë ¥ ê²°ê³¼

    ```
    SingletonBean.init
    singletonBean1 = hello.core.scope.SingletonTest$SingletonBean@7e242b4d
    singletonBean2 = hello.core.scope.SingletonTest$SingletonBean@7e242b4d
    SingletonBean.destroy
    ```

  - ë¹ˆ ì´ˆê¸°í™” ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ê³ , ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ì˜ ë¹ˆì„ ì¡°íšŒí•˜ê³ , ì¢…ë£Œ ë©”ì„œë“œê¹Œì§€ ì •ìƒ í˜¸ì¶œëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ

> í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„
<br> - scope/PrototypeTest.java

- ì¶œë ¥ ê²°ê³¼

    ```
    find prototypeBean1
    PrototypeBean.init
    find prototypeBean2
    PrototypeBean.init
    prototypeBean1 = hello.core.scope.PrototypeTest$PrototypeBean@7e242b4d
    prototypeBean2 = hello.core.scope.PrototypeTest$PrototypeBean@305f031
    ```

  - ì‹±ê¸€í†¤ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œì ì— ì´ˆê¸°í™” ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ì§€ë§Œ, í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ë¹ˆì„ ì¡°íšŒí•  ë•Œ ìƒì„±ë˜ê³ , ì´ˆê¸°í™” ë©”ì„œë“œë„ ì‹¤í–‰ëœë‹¤.
  - í”„ë¡œí† íƒ€ì… ë¹ˆì„ 2ë²ˆ ì¡°íšŒí–ˆìœ¼ë¯€ë¡œ ì™„ì „íˆ ë‹¤ë¥¸ ìŠ¤í”„ë§ ë¹ˆì´ ìƒì„±ë˜ê³ , ì´ˆê¸°í™”ë„ 2ë²ˆ ì‹¤í–‰ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
  - ì‹±ê¸€í†¤ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì— ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ ë¹ˆì˜ ì¢…ë£Œ ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ì§€ë§Œ, í”„ë¡œí† íƒ€ì… ë¹„ëŠ¥ã„´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ìƒì„±ê³¼ ì˜ì¡´ê´€ê³„ ì£¼ì…, ê·¸ë¦¬ê³  ì´ˆê¸°í™”ê¹Œì§€ë§Œ ê´€ì—¬í•˜ê³ , ë”ëŠ” ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
  - ë”°ë¼ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ, `@PreDestory` ê°™ì€ ì¢…ë£Œ ë©”ì„œë“œê°€ ì „í˜€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.

### í”„ë¡œí† íƒ€ì… ë¹ˆì˜ íŠ¹ì§• ì •ë¦¬

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•  ë•Œë§ˆë‹¤ ìƒˆë¡œ ìƒì„±ëœë‹¤
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì˜ ìƒì„±ê³¼ ì˜ì¡´ê´€ê³„ ì£¼ì… ê·¸ë¦¬ê³  ì´ˆê¸°í™”ê¹Œì§€ë§Œ ê´€ì—¬í•œë‹¤
- ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤
- ê·¸ë˜ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì¡°íšŒí•œ í´ë¼ì´ì–¸íŠ¸ê°€ ê´€ë¦¬í•´ì•¼ í•œë‹¤
- ì¢…ë£Œ ë©”ì„œë“œì— ëŒ€í•œ í˜¸ì¶œë„ í´ë¼ì´ì–¸íŠ¸ê°€ ì§ì ‘ í•´ì•¼ í•œë‹¤.

<br>

## í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ - ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©ì‹œ ë¬¸ì œì 

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì„ ìš”ì²­í•˜ë©´ í•­ìƒ ìƒˆë¡œìš´ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜í•œë‹¤
- í•˜ì§€ë§Œ ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©í•  ë•ŒëŠ” ì˜ë„í•œ ëŒ€ë¡œ ì˜ ë™ì‘í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì£¼ì˜í•´ì•¼ í•œë‹¤

> í”„ë¡œí† íƒ€ì… ë¹ˆ ì§ì ‘ ìš”ì²­

**ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆ ì§ì ‘ ìš”ì²­1**

<img src="https://github.com/iieunji023/spring-core/blob/main/images/í”„ë¡œí† íƒ€ì…_ë¹ˆ1.png" width="500">

1. í´ë¼ì´ì–¸íŠ¸AëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìš”ì²­í•œë‹¤
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒˆë¡œ ìƒì„±í•´ì„œ ë°˜í™˜(x01)í•œë‹¤. í•´ë‹¹ ë¹ˆì˜ count í•„ë“œ ê°’ì€ 0ì´ë‹¤
3. í´ë¼ì´ì–¸íŠ¸ëŠ” ì¡°íšŒí•œ í”„ë¡œí† íƒ€ì… ë¹ˆì— addCount()ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ count í•„ë“œë¥¼ +1 í•œë‹¤.
- ê²°ê³¼ì ìœ¼ë¡œ í”„ë¡œí† íƒ€ì… ë¹ˆ(x01)ì˜ countëŠ” 1ì´ ëœë‹¤.

**ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆ ì§ì ‘ ìš”ì²­2**

<img src="https://github.com/iieunji023/spring-core/blob/main/images/í”„ë¡œí† íƒ€ì…_ë¹ˆ2.png" width="500">

1. í´ë¼ì´ì–¸íŠ¸BëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìš”ì²­í•œë‹¤.
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒˆë¡œ ìƒì„±í•´ì„œ ë°˜í™˜(x02)í•œë‹¤. í•´ë‹¹ ë¹ˆì˜ count í•„ë“œ ê°’ì€ 0ì´ë‹¤.
3. í´ë¼ì´ì–¸íŠ¸ëŠ” ì¡°íšŒí•œ í”„ë¡œí† íƒ€ì… ë¹ˆì— addCount()ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ  count í•„ë“œë¥¼ +1 í•œë‹¤.
- ê²°ê³¼ì ìœ¼ë¡œ í”„ë¡œí† íƒ€ì… ë¹ˆ(x02)ì˜ countëŠ” 1ì´ ëœë‹¤.

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

> **í”„ë¡œí† íƒ€ì… ë¹ˆ ì§ì ‘ ìš”ì²­**
<br> - SingletonWithPrototypeTest

- ì¶œë ¥ê²°ê³¼

    ```
    PrototypeBean.init hello.core.scope.SingletonWithPrototypeTest$PrototypeBean@32f0fba8
    PrototypeBean.init hello.core.scope.SingletonWithPrototypeTest$PrototypeBean@299266e2
    ```

  - ê°ì²´ê°€ ì´ˆê¸°í™”ë˜ë©´ì„œ ë‹¤ë¥¸ ê°ì²´ê°€ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸
  - ì¢…ë£Œ ë©”ì„œë“œëŠ” ì¶œë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤
    (í”„ë¡œí† íƒ€ì…ì€ ì˜ì¡´ê´€ê³„ ì£¼ì…, ì´ˆê¸°í™”ê¹Œì§€ë§Œ í•´ì£¼ê¸° ë•Œë¬¸)

> ì‹±ê¸€í†¤ ë¹ˆì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©

- ClientBeanì´ë¼ëŠ” ì‹±ê¸€í†¤ ë¹ˆì´ ì˜ì¡´ê´€ê³„ ì£¼ì••ì„ í†µí•´ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì£¼ì…ë°›ì•„ì„œ ì‚¬ìš©í•´ë³´ì

**ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©1**

<img src="https://github.com/iieunji023/spring-core/blob/main/images/í”„ë¡œí† íƒ€ì…_ë¹ˆ3.png" width="500">

- clientBeanì€ ì‹±ê¸€í†¤ì´ë¯€ë¡œ, ë³´í†µ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œì ì— í•¨ê»˜ ìƒì„±ë˜ê³ , ì˜ì¡´ ê´€ê³„ ì£¼ì…ë„ ë°œìƒí•œë‹¤.
1. clientBeanì€ ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…ì„ ì‚¬ìš©í•œë‹¤. ì£¼ì… ì‹œì ì— ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìš”ì²­í•œë‹¤.
2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•´ì„œ clientBeanì— ë°˜í™˜í•œë‹¤. í”„ë¡œí† íƒ€ì… ë¹ˆì˜ count í•„ë“œ ê°’ì€ 0ì´ë‹¤.
- ì´ì œ clientBeanì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ë‚´ë¶€ í•„ë“œì— ë³´ê´€í•œë‹¤.
(ì •í™•íˆëŠ” ì°¸ì¡°ê°’ì„ ë³´ê´€í•œë‹¤)

**ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©2**

<img src="https://github.com/iieunji023/spring-core/blob/main/images/í”„ë¡œí† íƒ€ì…_ë¹ˆ4.png" width="500">

- í´ë¼ì´ì–¸íŠ¸AëŠ” clientBeanì„ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•´ì„œ ë°›ëŠ”ë‹¤. ì‹±ê¸€í†¤ì´ë¯€ë¡œ í•­ìƒ ê°™ì€ clientBeanì´ ë°˜í™˜ëœë‹¤.
1. í´ë¼ì´ì–¸íŠ¸AëŠ” clientBean.logic()ì„ í˜¸ì¶œí•œë‹¤
2. clientBeanì€ prototypeBeanì˜ addCount()ë¥¼ í˜¸ì¶œí•´ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì˜ countë¥¼ ì¦ê°€í•œë‹¤. countê°’ì´ 1ì´ ëœë‹¤

**ì‹±ê¸€í†¤ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©3**

<img src="https://github.com/iieunji023/spring-core/blob/main/images/í”„ë¡œí† íƒ€ì…_ë¹ˆ5.png" width="500">

- í´ë¼ì´ì–¸íŠ¸BëŠ” clientBeanì„ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•´ì„œ ë°›ëŠ”ë‹¤. ì‹±ê¸€í†¤ì´ë¯€ë¡œ í•­ìƒ ê°™ì€ clientBeanì´ ë°˜í™˜ëœë‹¤
- â­ ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì !! clientBeanì´ ë‚´ë¶€ì— ê°€ì§€ê³  ìˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì€ ì´ë¯¸ ê³¼ê±°ì— ì£¼ì…ì´ ëë‚œ ë¹ˆì´ë‹¤. ì£¼ì… ì‹œì ì— ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­ì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒˆë¡œ ìƒì„±ëœ ê²ƒì´ì§€, ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ìƒˆë¡œ ìƒì„±ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤!!â­
1. í´ë¼ì´ì–¸íŠ¸BëŠ” clientBean.logic()ì„ í˜¸ì¶œí•œë‹¤
2. clientBeanì€ prototypeBeanì˜ addCount()ë¥¼ í˜¸ì¶œí•´ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì˜ countë¥¼ ì¦ê°€í•œë‹¤. ì›ë˜ countê°’ì´ 1ì´ì—ˆìœ¼ë¯€ë¡œ 2ê°€ ëœë‹¤.

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

> **ì‹±ê¸€í†¤ ë¹ˆì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©**
<br> - SingletonWithPrototypeTest

- ClientBean í´ë˜ìŠ¤ì™€ singletonClientUsePrototype ë©”ì„œë“œ ì¶”ê°€
- ì¶œë ¥ ê²°ê³¼

    ```
    PrototypeBean.init hello.core.scope.SingletonWithPrototypeTest$PrototypeBean@6e4de19b
    ```

  - ì´ˆê¸°í™”ê°€ í•œë²ˆë§Œ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ
  - countë„ 2ë¡œ ì˜¬ë¼ê°€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ

- ìŠ¤í”„ë§ì€ ì¼ë°˜ì ìœ¼ë¡œ ì‹±ê¸€í†¤ ë¹ˆì„ ì‚¬ìš©í•˜ë¯€ë¡œ, ì‹±ê¸€í†¤ ë¹ˆì´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.
- ê·¸ëŸ°ë° ì‹±ê¸€í†¤ ë¹ˆì€ ìƒì„±ì‹œì ì—ë§Œ ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ë°›ê¸° ë•Œë¬¸ì— í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒˆë¡œ ìƒì„±ë˜ê¸°ëŠ” í•˜ì§€ë§Œ, ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ê³„ì† ìœ ì§€ë˜ëŠ” ê²ƒì´ ë¬¸ì œë‹¤
- í”„ë¡œí† íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì£¼ì… ì‹œì ì—ë§Œ ìƒˆë¡œ ìƒì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ìƒˆë¡œ ìƒì„±í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì›í•  ê²ƒì´ë‹¤!!

> ğŸ’¡ ì°¸ê³ 
<br> - ì—¬ëŸ¬ ë¹ˆì—ì„œ ê°™ì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì£¼ì… ë°›ìœ¼ë©´, ì£¼ì… ë°›ëŠ” ì‹œì ì— ê°ê° ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ëœë‹¤.
<br> - ì˜ˆë¥¼ ë“¤ì–´, clientA, clientBê°€ ê°ê° ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ë°›ìœ¼ë©´ ê°ê° ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì˜ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì£¼ì… ë°›ëŠ”ë‹¤
<br>   clientA  prototypeBean@x01
<br>   clientB  prototypeBean@x02
<br> - ë¬¼ë¡  ì‚¬ìš©í•  ë•Œ ë§ˆë‹¤ ìƒˆë¡œ ìƒì„±ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

<br>

## í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ - ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©ì‹œ Providerë¡œ ë¬¸ì œ í•´ê²°

- ì‹±ê¸€í†¤ ë¹ˆê³¼ í”„ë¡œí† íƒ€ì… ë¹ˆì„ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ, ì–´ë–»ê²Œ í•˜ë©´ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•  ìˆ˜ ìˆì„ê¹Œ?

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

> **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­**
<br> - SingletonWithPrototypeTest.java
<details>
<summary>ì½”ë“œ</summary>

        public class PrototypeProviderTest {

        @Test
        void providerTest() {
          AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);
          ClientBean clientBean1 = ac.getBean(ClientBean.class);
          int count1 = clientBean1.logic();
          assertThat(count1).isEqualTo(1);

          ClientBean clientBean2 = ac.getBean(ClientBean.class);
          int count2 = clientBean2.logic();
          assertThat(count2).isEqualTo(1);
        }
		 
        static class ClientBean {
          @Autowired
          private ApplicationContext ac;
			 
          public int logic() {
          PrototypeBean prototypeBean = ac.getBean(PrototypeBean.class);
          prototypeBean.addCount();
          int count = prototypeBean.getCount();
          return count;
          }
        }

          @Scope("prototype")
          static class PrototypeBean {
          private int count = 0;
          public void addCount() {
            count++;
          }
		   
          public int getCount() {
            return count;
          }
		        
          @PostConstruct
          public void init() {
            System.out.println("PrototypeBean.init " + this);
          }
		    
          @PreDestroy
          public void destroy() {
            System.out.println("PrototypeBean.destroy");
          }
        }
    }

- ì‹¤í–‰í•´ë³´ë©´ `ac.getBean()`ì„ í†µí•´ì„œ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
- ì˜ì¡´ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…(DI) ë°›ëŠ”ê²Œ ì•„ë‹ˆë¼ ì´ë ‡ê²Œ ì§ì ‘ í•„ìš”í•œ ì˜ì¡´ê´€ê³„ë¥¼ ì°¾ëŠ” ê²ƒì„Dependency Lookup(DL) ì˜ì¡´ê´€ê³„ ì¡°íšŒ(íƒìƒ‰) ì´ë¼í•œë‹¤.
- ê·¸ëŸ°ë° ì´ë ‡ê²Œ ìŠ¤í”„ë§ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ì „ì²´ë¥¼ ì£¼ì…ë°›ê²Œ ë˜ë©´, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì¢…ì†ì ì¸ ì½”ë“œê°€ ë˜ê³ , ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë„ ì–´ë ¤ì›Œì§„ë‹¤.
- ì§€ê¸ˆ í•„ìš”í•œ ê¸°ëŠ¥ì€ ì§€ì •í•œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì»¨í…Œì´ë„ˆì—ì„œ ëŒ€ì‹  ì°¾ì•„ì£¼ëŠ” ë”±! DLì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µí•˜ëŠ” ë¬´ì–¸ê°€ê°€ ìˆìœ¼ë©´ ëœë‹¤.

</details>

### ObjectFactory, ObjectProvider

- ì§€ì •í•œ ë¹ˆì„ ì»¨í…Œì´ë„ˆì—ì„œ ëŒ€ì‹  ì°¾ì•„ì£¼ëŠ” DL ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ê²ƒì´ ë°”ë¡œ `ObjectProvider`ì´ë‹¤.
- ì°¸ê³ ë¡œ ê³¼ê±°ì—ëŠ” `ObjectFactory`ê°€ ìˆì—ˆëŠ”ë°, ì—¬ê¸°ì— í¸ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì„œ `ObjectProvider` ê°€ ë§Œë“¤ì–´ì¡Œë‹¤.

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

> SingletonWithPrototypeTest.java
<details>
<summary>ì½”ë“œ</summary>

        public class SingletonWithPrototypeTest {
        @Test
        void prototypeFind() {
          AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);

          PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
          prototypeBean1.addCount();
          assertThat(prototypeBean1.getCount()).isEqualTo(1);

          PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
          prototypeBean2.addCount();
          assertThat(prototypeBean2.getCount()).isEqualTo(1);

        }

        @Test
        void singletonClientUsePrototype() {
          AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);

          ClientBean clientBean1 = ac.getBean(ClientBean.class);
          int count1 = clientBean1.logic();
          assertThat(count1).isEqualTo(1);

          ClientBean clientBean2 = ac.getBean(ClientBean.class);
          int count2 = clientBean2.logic();
          assertThat(count2).isEqualTo(1);

        }

        @Scope("singleton")
        static class ClientBean{
          @Autowired
          private ObjectProvider<PrototypeBean> prototypeBeanProvider;
        
          public int logic() {
            PrototypeBean prototypeBean = prototypeBeanProvider.getObject();
            prototypeBean.addCount();
            int count =  prototypeBean.getCount();
            return count;
          }
        }

        @Scope("prototype")
        static class PrototypeBean{
          private int count = 0;

          public void addCount() {
            count++;
          }

          public int getCount() {
            return count;
          }

          @PostConstruct
          public void init() {
            System.out.println("PrototypeBean.init " + this);
          }

          @PreDestroy
          public void destroy() {
            System.out.println("PrototypeBean.destroy");
          }
      }
    }


- ì‹¤í–‰í•´ë³´ë©´ `prototypeBeanProvider.getObject()`ì„ í†µí•´ì„œ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤
- `ObjectProvider`ì˜ `getobject()`ë¥¼ í˜¸ì¶œí•˜ë©´ ë‚´ë¶€ì—ì„œëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤(**DL**)
- ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê±°ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ëŠ” í›¨ì”¬ ì‰¬ì›Œì§„ë‹¤.

</details>

**íŠ¹ì§•**

- `ObjectFactory`: ê¸°ëŠ¥ì´ ë‹¨ìˆœ, ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”ì—†ìŒ, ìŠ¤í”„ë§ì— ì˜ì¡´
- `ObjectProvider`: `ObjectFactory` ìƒì†, ì˜µì…˜, ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ ë“± í¸ì˜ ê¸°ëŠ¥ì´ ë§ê³ , ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”ì—†ìŒ

### SR-330 Provider

- `jakarta.inject.Provider` ë¼ëŠ” JSR-330 ìë°” í‘œì¤€ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤
- ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ gradleì— ì¶”ê°€

> build.gradle


```
dependencies {
	implementation 'jakarta.inject:jakarta.inject-api:2.0.1'
}
```

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

> SingletonWithPrototypeTest.java
<details>
<summary>ì½”ë“œ</summary>


      public class SingletonWithPrototypeTest {
      @Test
      void prototypeFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);

        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
        prototypeBean1.addCount();
        assertThat(prototypeBean1.getCount()).isEqualTo(1);

        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
        prototypeBean2.addCount();
        assertThat(prototypeBean2.getCount()).isEqualTo(1);

    }

      @Test
      void singletonClientUsePrototype() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);

        ClientBean clientBean1 = ac.getBean(ClientBean.class);
        int count1 = clientBean1.logic();
        assertThat(count1).isEqualTo(1);

        ClientBean clientBean2 = ac.getBean(ClientBean.class);
        int count2 = clientBean2.logic();
        assertThat(count2).isEqualTo(1);

      }

      @Scope("singleton")
      static class ClientBean{

        @Autowired
        private Provider<PrototypeBean> prototypeBeanProvider;

        public int logic() {
            PrototypeBean prototypeBean = prototypeBeanProvider.get();
            prototypeBean.addCount();
            int count =  prototypeBean.getCount();
            return count;
        }
      }

      @Scope("prototype")
      static class PrototypeBean{
        private int count = 0;

        public void addCount() {
            count++;
        }

        public int getCount() {
            return count;
        }

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init " + this);
        }

        @PreDestroy
        public void destroy() {
            System.out.println("PrototypeBean.destroy");
        }
      }
  }

- ì‹¤í–‰í•´ë³´ë©´ `prototypeBeanProvider.get()`ì„ í†µí•´ì„œ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
- `providerì˜ get()`ì„ í˜¸ì¶œí•˜ë©´ ë‚´ë¶€ì—ì„œëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤.(**DL**)
- ìë°” í‘œì¤€ì´ê³ , ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê±°ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ëŠ” í›¨ì”¬ ì‰¬ì›Œì§„ë‹¤.
- ProviderëŠ” ì§€ê¸ˆ ë”± í•„ìš”í•œ DLì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µí•œë‹¤.

</details>

**íŠ¹ì§•**

- `get()` ë©”ì„œë“œ í•˜ë‚˜ë¡œ ê¸°ëŠ¥ì´ ë§¤ìš° ë‹¨ìˆœí•˜ë‹¤
- ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•˜ë‹¤
- ìë°” í‘œì¤€ì´ë¯€ë¡œ ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤

### ì •ë¦¬

- ê·¸ëŸ¬ë©´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì–¸ì œ ì‚¬ìš©í•˜ëŠ”ê°€?
- ë§¤ë²ˆ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ì˜ì¡´ê´€ê³„ ì£¼ì…ì´ ì™„ë£Œëœ ìƒˆë¡œìš´ ê°ì²´ê°€ í•„ìš”í•˜ë©´ ì‚¬ìš©í•˜ë©´ ëœë‹¤
- ê·¸ëŸ°ë° ì‹¤ë¬´ì—ì„œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•´ë³´ë©´, ì‹±ê¸€í†¤ ë¹ˆìœ¼ë¡œ ëŒ€ë¶€ë¶„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì§ì ‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì¼ì€ ë§¤ìš° ë“œë¬¼ë‹¤
- `ObjectProvider`, `JSR330 Provider` ë“±ì€ í”„ë¡œí† íƒ€ì… ë¿ë§Œ ì•„ë‹ˆë¼ DLì´ í•„ìš”í•œ ê²½ìš°ëŠ” ì–¸ì œë“ ì§€ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

<details>
<summary>ğŸ’¥ Provider ì˜ì¡´ì„± ì£¼ì… ê´€ë ¨ ì—ëŸ¬</summary>

[ì°¸ê³ ](https://www.inflearn.com/community/questions/722428/javax-inject-provider-%EC%A3%BC%EC%9E%85-%EC%A7%88%EB%AC%B8)

- ë¬¸ì œìƒí™©
  ```
  Error creating bean with name 'singletonWithPrototypeTest.ClientBean': Unsatisfied dependency expressed through field 'prototypeBeanProvider': No qualifying bean of type 'javax.inject.Provider<hello.core.scope.SingletonWithPrototypeTest$PrototypeBean>' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}`
  ```
- ì›ì¸
  - ìŠ¤í”„ë§ ë¶€íŠ¸ ë²„ì „ í˜¸í™˜ì´ ì•ˆë¼ì„œ ë°œìƒí•œ ì˜¤ë¥˜
- í•´ê²°
  - **build.gradleì— ì¶”ê°€í–ˆë˜ ê¸°ì¡´ì˜** `implementation 'javax.inject:javax.inject:1'` ë¥¼ ì œê±°í•˜ê³ ,
  - **`implementation 'jakarta.inject:jakarta.inject-api:2.0.1'` ë¡œ ì¶”ê°€í•´ì£¼ë©´ ë¨!**

</details>