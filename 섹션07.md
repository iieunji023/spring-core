## μ»΄ν¬λ„νΈ μ¤μΊ”κ³Ό μμ΅΄κ΄€κ³„ μλ™ μ£Όμ… μ‹μ‘ν•κΈ°

- μ§€κΈκΉμ§€ μ¤ν”„λ§ λΉμ„ λ“±λ΅ν•  λ•λ” μλ°” μ½”λ“μ `@Bean`μ΄λ‚ XMLμ `<bean>`μ„ ν†µν•΄ μ„¤μ • μ •λ³΄μ— μ§μ ‘ λ“±λ΅ν•  μ¤ν”„λ§ λΉμ„ λ‚μ—΄ν–λ‹¤
- μ¤ν”„λ§ λΉμ΄ μλ°± κ°κ°€ λλ©΄ μΌμΌμ΄ λ“±λ΅ν•κΈ° μ–΄λ ¤μΈ λΏ μ•„λ‹λΌ μ„¤μ • μ •λ³΄λ„ μ»¤λ¦¬κ³  λ„λ½ν•λ” λ¬Έμ κ°€ λ°μƒν•λ‹¤
- κ·Έλμ„ μ¤ν”„λ§μ€ μ„¤μ • μ •λ³΄κ°€ μ—†μ–΄λ„ μλ™μΌλ΅ μ¤ν”„λ§ λΉμ„ λ“±λ΅ν•λ” μ»΄ν¬λ„νΈ μ¤μΊ”μ΄λΌλ” κΈ°λ¥μ„ μ κ³µν•λ‹¤
- λ μμ΅΄κ΄€κ³„λ„ μλ™μΌλ΅ μ£Όμ…ν•λ” `@Autowired`λΌλ” κΈ°λ¥λ„ μ κ³µν•λ‹¤

π’΅ μ‹¤μ  μ½”λ“λ¥Ό ν†µν•΄ **μ»΄ν¬λ„νΈ μ¤μΊ”**κ³Ό **μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…**μ— λ€ν•΄ μ•μ•„λ³΄λ ¤ ν•λ‹¤

> AutoAppConfig - μ„¤μ • μ •λ³΄ 
> <br> - @Configuration 
> <br> -@ComponentScan

- μ»΄ν¬λ„νΈ μ¤μΊ”μ„ μ‚¬μ©ν•λ ¤λ©΄ λ¨Όμ € `@ComponentScan`μ„ μ„¤μ • μ •λ³΄μ— λ¶™μ—¬μ£Όλ©΄ λλ‹¤
- κΈ°μ΅΄μ AppConfigμ™€ λ‹¬λ¦¬ `@Bean`μΌλ΅ λ“±λ΅ν• ν΄λμ¤κ°€ ν•λ‚λ„ μ—†μ

```
π’΅ μ°Έκ³ 
- μ»΄ν¬λ„νΈ μ¤μΊ”μ„ μ‚¬μ©ν•λ©΄ `@Configuration`μ΄ λ¶™μ€ μ„¤μ • μ •λ³΄λ„ μλ™μΌλ΅ λ“±λ΅λκΈ° λ•λ¬Έμ— AppConfig, TestConfig λ“± μ•μ„ λ§λ“¤μ–΄λ‘μ—λ μ„¤μ • μ •λ³΄λ„ ν•¨κ» λ“±λ΅λκ³ , μ‹¤ν–‰λλ‹¤
- κ·Έλμ„ excludeFiltersλ¥Ό μ΄μ©ν•΄μ„ μ„¤μ • μ •λ³΄λ” μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ—μ„ μ μ™Έν–λ‹¤
(Configuration μ–΄λ…Έν…μ΄μ…μ΄ λ¶™μ–΄μλ” ν΄λμ¤)
- λ³΄ν†µ μ„¤μ • μ •λ³΄λ¥Ό μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ—μ„ μ μ™Έν•μ§€λ” μ•μ§€λ§, κΈ°μ΅΄ μμ  μ½”λ“λ¥Ό μµλ€ν• λ‚¨κΈ°κ³  μ μ§€ν•κΈ° μ„ν•΄ μ‚¬μ©
```

π”Ή μ»΄ν¬λ„νΈ μ¤μΊ”(`@ComponentScan`)μ€ μ΄λ¦„ κ·Έλ€λ΅ `@Component` μ–΄λ…Έν…μ΄μ…μ΄ λ¶™μ€ ν΄λμ¤λ¥Ό μ¤μΊ”ν•΄μ„ μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•λ‹¤<br>
π”Ή `@Component`λ¥Ό λ¶™μ—¬μ£Όμ

> MemoryMemberRepository, MemberServiceImpl, RateDiscountPolicy, OrderServiceImpl - λΉ μλ™ λ“±λ΅

<details>
      <summary>MemoryMemberRepository - @Compont</summary>

        @Component
        public class MemoryMemberRepository implements MemberRepository{}

</details>

<details>
      <summary>RateDiscountPolicy  - @Compont</summary>

        @Component
        public class RateDiscountPolicy implements DiscountPolicy {}

</details>

<details>
      <summary>MemberServiceImpl - @Compont, @Autowired</summary>

        @Component
        public class MemberServiceImpl implements MemberService{
        private final  MemberRepository memberRepository;

        @Autowired  //ac.getBean(MemberRepository.class)
        public MemberServiceImpl(MemberRepository memberRepository) {
            this.memberRepository = memberRepository;
            }
        }

- μ΄μ „μ—λ” AppConfigμ—μ„ @Beanμ„ ν†µν•΄ μμ΅΄κ΄€κ³„λ¥Ό λ‚΄κ°€ μ£Όμ…ν•΄μ¤¬λ‹¤
- κ·Έλ¬λ‚ AutoAppConfig ν΄λμ¤ λ‚΄μ—λ” μμ΅΄ κ΄€κ³„λ¥Ό μ£Όμ…ν•λ” μ½”λ“κ°€ μ—†μ
- λ”°λΌμ„ μ΄μ  μμ΅΄κ΄€κ³„λ¥Ό μλ™μΌλ΅ μ£Όμ…ν•΄μ¤μ•Ό ν•¨ β‡’ `@Autowired` μ‚¬μ©!!
    - `@Autowired`== `//ac.getBean(MemberRepository.class)`

</details>

<details>
      <summary>RateDiscountPolicy  - @Compont</summary>

        @Component
        public class OrderServiceImpl implements OrderService {
        private final MemberRepository memberRepository;
        private final DiscountPolicy discountPolicy;

        @Autowired
        public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
            this.memberRepository = memberRepository;
            this.discountPolicy = discountPolicy;
            }
        }

- @Autowiredλ¥Ό μ‚¬μ©ν•λ©΄ μƒμ„±μμ—μ„ μ—¬λ¬ μμ΅΄κ΄€κ³„λ„ ν•λ²μ— μ£Όμ…λ°›μ„ μ μλ‹¤

</details>

### ν…μ¤νΈ μ½”λ“ μ‘μ„±

> AutoAppConfigTest
- `AnnotationConfigApplicationContext`λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ κΈ°μ΅΄κ³Ό λ™μΌ
- μ„¤μ • μ •λ³΄λ¥Όλ΅ `AutoAppConfig` ν΄λμ¤ λ„κ²¨μ¤

```
ClassPathBeanDefinitionScanner - Identified candidate component class:
 .. RateDiscountPolicy.class
 .. MemberServiceImpl.class
 .. MemoryMemberRepository.class
 .. OrderServiceImpl.class
```
- μ»΄ν¬λ„νΈ μ¤μΊ”μ΄ μ λ™μ‘ν•λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤

### @ComponentScan

<img src="https://github.com/iieunji023/spring-core/blob/main/images/componentScan.png" width="500">

- `@ComponentScan`μ€ `@Component`κ°€ λ¶™μ€ λ¨λ“  ν΄λμ¤λ¥Ό μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•λ‹¤
- μ΄λ• μ¤ν”„λ§ λΉμ κΈ°λ³Έ μ΄λ¦„μ€ **ν΄λμ¤λ…**μ„ μ‚¬μ©ν•λ **λ§¨ μ•κΈ€μλ§ μ†λ¬Έμλ¥Ό μ‚¬μ©**
  - λΉ μ΄λ¦„ κΈ°λ³Έ μ „λµ: MemberServiceImpl ν΄λμ¤ β†’ memberServiceImpl
  - λΉ μ΄λ¦„ μ§μ ‘ μ§€μ •: λ§μ•½ μ¤ν”„λ§ λΉμ μ΄λ¦„μ„ μ§μ ‘ μ§€μ •ν•κ³  μ‹¶μΌλ©΄ `@Component(β€memberService2β€)`λ΅ λ¶€μ—¬

### @Autowired μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…

<img src="https://github.com/iieunji023/spring-core/blob/main/images/autowired.png" width="500">

- μƒμ„±μμ— `@Autowired`λ¥Ό μ§€μ •ν•λ©΄, μ¤ν”„λ§ μ»¨ν…μ΄λ„κ°€ μλ™μΌλ΅ ν•΄λ‹Ή μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ£Όμ…ν•λ‹¤
- μ΄λ• κΈ°λ³Έ μ΅°ν μ „λµμ€ **νƒ€μ…μ΄ κ°™μ€ λΉμ„ μ°Ύμ•„μ„ μ£Όμ…ν•λ‹¤**
  - `getBean(MemberRepository.class)`μ™€ λ™μΌν•λ‹¤κ³  μ΄ν•΄ν•λ©΄ λλ‹¤

<img src="https://github.com/iieunji023/spring-core/blob/main/images/autowired1.png" width="500">

- μƒμ„±μμ— νλΌλ―Έν„°κ°€ λ§μ•„λ„ λ‹¤ μ°Ύμ•„μ„ μλ™μΌλ΅ μ£Όμ…νλ‹¤

## νƒμƒ‰ μ„μΉμ™€ κΈ°λ³Έ μ¤μΊ” λ€μƒ

### νƒμƒ‰ν•  ν¨ν‚¤μ§€μ μ‹μ‘ μ„μΉ μ§€μ •

- λ¨λ“  μλ°” ν¬λμ¤λ¥Ό λ‹¤ μ»΄ν¬λ„νΈ μ¤μΊ”ν•λ©΄ μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬λ―€λ΅ ν•„μ”ν• μ„μΉλ¶€ν„° νƒμƒ‰ν•λ„λ΅ μ‹μ‘ μ„μΉλ¥Ό μ •ν•  μ μλ‹¤.

```
  @ComponentScan(
          basePackages = "hello.core.member", // μ–΄λ””μ„λ¶€ν„° νƒμƒ‰ν• μ§€ μ§€μ •ν•  μ μμ
          basePackageClasses = AutoAppConfig.class,
          excludeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = Configuration.class)
  )
```

- `basePackages`
  - νƒμƒ‰ν•  ν¨ν‚¤μ§€ μ‹μ‘ μ„μΉ μ§€μ •
  - μ΄ ν¨ν‚¤μ§€λ¥Ό ν¬ν•¨ν•΄μ„ ν•μ„ ν¨ν‚¤μ§€λ¥Ό λ¨λ‘ νƒμƒ‰
  - μ‹μ‘ μ„μΉλ¥Ό μ—¬λ¬ κ° μ§€μ •ν•  μ μμ
    - `basePackages = {"hello.core", "hello.service"}`
- `basePackageClasses`
  - μ§€μ •ν• ν΄λμ¤μ ν¨ν‚¤μ§€λ¥Ό νƒμƒ‰ μ‹μ‘ μ„μΉλ΅ μ§€μ •
- λ§μ•½ μ§€μ •ν•μ§€ μ•μΌλ©΄ `@ComponentScan`μ΄ λ¶™μ€ μ„¤μ • μ •λ³΄ ν΄λμ¤μ ν¨ν‚¤μ§€κ°€ μ‹μ‘ μ„μΉκ°€ λλ‹¤

> κ¶μ¥ν•λ” λ°©λ²•

- ν¨ν‚¤μ§€ μ„μΉλ¥Ό μ§€μ •ν•μ§€ μ•κ³ , **μ„¤μ • μ •λ³΄ ν΄λμ¤μ μ„μΉλ¥Ό ν”„λ΅μ νΈ μµμƒλ‹¨**μ— λ‘λ” κ²ƒμ΄λ‹¤.

μ•„λμ™€ κ°™μ€ ν”„λ΅μ νΈ κµ¬μ΅°κ°€ μλ‹¤λ©΄

π”Ή `com.hello`

π”Ή `com.hello.service`

π”Ή `com.hello.repository`

- `com.hello` β†’ ν”„λ΅μ νΈ μ‹μ‘ λ£¨νΈμ— AppConfig κ°™μ€ λ©”μΈ μ„¤μ • μ •λ³΄λ¥Ό λ‘κ³ , `@ComponentScan` μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ΄κ³ , `basePackages` μ§€μ •μ€ μƒλµν•λ” λ°©μ‹μ„ κ¶μ¥
- μ΄λ ‡κ² ν•λ©΄ `com.hello` λ¥Ό ν¬ν•¨ν• ν•μ„λ” λ¨λ‘ μλ™μΌλ΅ μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ΄ λ¨
- λ, ν”„λ΅μ νΈ λ©”μΈ μ„¤μ • μ •λ³΄λ” ν”„λ΅μ νΈλ¥Ό λ€ν‘ν•λ” μ •λ³΄μ΄κΈ° λ•λ¬Έμ— ν”„λ΅μ νΈ μ‹μ‘ λ£¨νΈ μ„μΉμ— λ‘λ” κ²ƒμ΄ μΆ‹μ

```
π’΅ μ°Έκ³ 
- μ¤ν”„λ§λ¶€νΈ μ‚¬μ©μ‹ μ¤ν”„λ§λ¶€νΈ λ€ν‘ μ‹μ‘ μ •λ³΄μΈ `@SpringBootApplication`λ¥Ό μ΄ ν”„λ΅μ νΈ μ‹μ‘ λ£¨νΈ μ„μΉμ— λ‘λ” κ²ƒμ΄ κ΄€λ΅€
- μ΄ μ„¤μ • μ•μ— `@ComponentScan`μ΄ λ“¤μ–΄μμ!
```

### μ»΄ν¬λ„νΈ μ¤μΊ” κΈ°λ³Έ λ€μƒ

π’΅ μ»΄ν¬λ„νΈ μ¤μΊ”μ€ @Component λΏλ§ μ•„λ‹λΌ λ‹¤μκ³Ό κ°™μ€ λ‚΄μ©λ„ λ€μƒμ— ν¬ν•¨λλ‹¤
- `@Component` μ»΄ν¬λ„νΈ μ¤μΊ”μ—μ„ μ‚¬μ©
- `@Controller` μ¤ν”„λ§ MVC μ»¨νΈλ΅¤λ¬μ—μ„ μ‚¬μ©
- `@Service` μ¤ν”„λ§ λΉ„μ¦λ‹μ¤ λ΅μ§μ—μ„ μ‚¬μ©
- `@Repository` μ¤ν”„λ§ λ°μ΄ν„° μ ‘κ·Ό κ³„μΈµμ—μ„ μ‚¬μ©
  - JPA, JDBC, β€¦
- `@Configuration` μ¤ν”„λ§ μ„¤μ • μ •λ³΄μ—μ„ μ‚¬μ©

```
π’΅ μ°Έκ³ 
- μ–΄λ…Έν…μ΄μ…μ—λ” μƒμ†κ΄€κ³„κ°€ μ—†λ‹¤
- μ–΄λ…Έν…μ΄μ…μ΄ νΉμ • μ–΄λ…Έν…μ΄μ…μ„ λ“¤κ³  μλ” κ±³μ„ μΈμ‹ν•  μ μλ” κ²ƒμ€ μλ°”κ°€ μ•„λ‹λΌ μ¤ν”„λ§μ΄ μ§€μ›ν•λ” κΈ°λ¥μ΄λ‹¤
```

π’΅ μ»΄ν¬λ„νΈ μ¤μΊ” μ©λ„λΏλ§ μ•„λ‹λΌ λ‹¤μ μ–΄λ…Έν…μ΄μ…μ΄ μμΌλ©΄ μ¤ν”„λ§μ€ λ¶€κ°€ κΈ°λ¥μ„ μν–‰ν•λ‹¤
- `@Controller` μ¤ν”„λ§ MVC μ»¨νΈλ΅¤λ¬λ΅ μΈμ‹
- `@Repository` μ¤ν”„λ§ λ°μ΄ν„° μ ‘κ·Ό κ³„μΈµμΌλ΅ μΈμ‹ν•κ³ , λ°μ΄ν„° κ³„μΈµμ μμ™Έλ¥Ό μ¤ν”„λ§ μμ™Έλ΅ λ³€ν™
- `@Configuration` μ¤ν”„λ§ μ„¤μ • μ •λ³΄λ¥Ό μΈμ‹ν•κ³ , μ¤ν”„λ§ λΉμ΄ μ‹±κΈ€ν†¤μ„ μ μ§€ν•λ„λ΅ μ¶”κ°€ μ²λ¦¬
- `@Service` νΉλ³„ν• μ²λ¦¬λ” ν•μ§€ μ•κ³ , κ°λ°μλ“¤μ΄ ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ μ—¬κΈ° μκµ¬λ‚ λΌκ³  λΉ„μ¦λ‹μ¤ κ³„μΈµμ„ μΈμ‹ν•λ”λ° λ„μ›€λ¨

## ν•„ν„°
- `includeFilters`μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ„ μ¶”κ°€λ΅ μ§€μ •ν•λ‹¤
- `excludeFilters` μ»΄ν¬λ„νΈ μ¤μΊ”μ—μ„ μ μ™Έν•  λ€μƒμ„ μ§€μ •ν•λ‹¤

π”» μ‹¤μµ κµ¬μ΅°
<img src="https://github.com/iieunji023/spring-core/blob/main/images/ν•„ν„°_μ‹¤μµκµ¬μ΅°.png" width="500">

### ν…μ¤νΈ μ½”λ“ μ‘μ„±

> μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ— μ¶”κ°€ν•  μ–΄λ…Έν…μ΄μ… - MyIncludeComponent

> μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ— μ μ™Έν•  μ–΄λ…Έν…μ΄μ… - MyExcludeComponent

> μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ— μ¶”κ°€ν•  ν΄λμ¤ - BeanA

> μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ— μ μ™Έν•  ν΄λμ¤ - BeanB

> μ„μ—μ„ μƒμ„±ν• μ–΄λ…Έν…μ΄μ…κ³Ό ν΄λμ¤λ¥Ό μ΄μ©ν•μ—¬ ν…μ¤νΈ μ§„ν–‰ - ComponentFilterAppConfigTest
- `includeFilters`μ— `MyIncludeComponent` μ–΄λ…Έν…μ΄μ…μ„ μ¶”κ°€ν•΄μ„ BeanAκ°€ μ¤ν”„λ§ λΉμ— λ“±λ΅λλ‹¤
- `excludeFilters`μ— `MyExcludeComponent` μ–΄λ…Έν…μ΄μ…μ„ μ¶”κ°€ν•΄μ„ BeanBλ” μ¤ν”„λ§ λΉμ— λ“±λ΅λμ§€ μ•λ”λ‹¤

### FilterType μµμ…

- ANNOTATION: κΈ°λ³Έκ°’, μ• λ…Έν…μ΄μ…μ„ μΈμ‹ν•΄μ„ λ™μ‘ν•λ‹¤
  - ex) `org.example.SomeAnnotation`
- ASSIGNABLE_TYPE: μ§€μ •ν• νƒ€μ…κ³Ό μμ‹ νƒ€μ…μ„ μΈμ‹ν•΄μ„ λ™μ‘ν•λ‹¤
  - ex) `org.example.SomeClass`
- ASPECTJ: AspectJ ν¨ν„΄ μ‚¬μ©
  - ex) `org.example..*Service+`
- REGEX: μ •κ· ν‘ν„μ‹
  - ex) `org\.example\.Default.*`
- CUSTOM: `TypeFilter`μ΄λΌλ” μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•΄μ„ μ²λ¦¬
- ex) `org.example.MyTypeFilter`

## μ¤‘λ³µ λ“±λ΅κ³Ό μ¶©λ

- μλ™ λΉ λ“±λ΅ vs μλ™ λΉ λ“±λ΅
- μλ™ λΉ λ“±λ΅ vs μλ™ λΉ λ“±λ΅

> μλ™ λΉ λ“±λ΅ vs μλ™ λΉ λ“±λ΅

- μ»΄ν¬λ„νΈ μ¤μΊ”μ— μν•΄ μλ™μΌλ΅ μ¤ν”„λ§ λΉμ΄ λ“±λ΅λλ”λ° κ·Έ μ΄λ¦„μ΄ κ°™μ€ κ²½μ° μ¤ν”„λ§μ€ μ¤λ¥λ¥Ό λ°μƒμ‹ν‚΄
  - `ConflictingBeanDefinitionException` μμ™Έ λ°μƒ

> μλ™ λΉ λ“±λ΅ vs μλ™ λΉ λ“±λ΅

π”» @Componentλ¥Ό ν†µν•΄ MemoryMemberRepository μλ™ λΉ λ“±λ΅
- μ΄ κ²½μ° μλ™ λΉ λ“±λ΅μ΄ μ°μ„ κ¶μ„ κ°€μ§„λ‹¤
- μλ™ λΉμ΄ μλ™ λΉμ„ μ¤λ²„λΌμ΄λ”©

λ΅κ·Έ

```
Overriding bean definition for bean 'memoryMemberRepository' with a different 
definition: replacing
```
- μ΄ κ²½μ° μ΅κΈ° μ–΄λ ¤μ΄ λ²„κ·Έκ°€ λ§λ“¤μ–΄μ§„λ‹¤
- κ·Έλμ„ μµκ·Ό μ¤ν”„λ§ λ¶€νΈμ—μ„λ” μλ™ λΉ λ“±λ΅κ³Ό μλ™ λΉ λ“±λ΅μ΄ μ¶©λλ‚λ©΄ μ¤λ¥κ°€ λ°μƒν•λ„λ΅ κΈ°λ³Έ κ°’μ„ λ°”κΎΈμ—λ‹¤

π”» μλ™ λΉ λ“±λ΅, μλ™ λΉ λ“±λ΅ μ¤λ¥μ‹ μ¤ν”„λ§ λ¶€νΈ μ—λ¬

```
Consider renaming one of the beans or enabling overriding by setting 
spring.main.allow-bean-definition-overriding=true
```

- `CoreApplication` μ‹¤ν–‰μ‹ μƒκΈ°λ” μ¤λ¥